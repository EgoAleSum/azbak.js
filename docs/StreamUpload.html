<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: StreamUpload</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: StreamUpload</h1>

    




<section>

<header>
    
        <h2>StreamUpload</h2>
        
            <div class="class-description"><p>Uploads a stream to Azure Blob Storage.</p>
<p>Azure Blob Storage can support up to 50,000 blocks of up to 100MB each,
for a total size of approximately ~4.8TB per blob (we're using block blobs).
For files larger than 4.8TB, multiple blobs are created, with names .000, .001, .002, etc.</p></div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    <h4 class="name" id="StreamUpload"><span class="type-signature"></span>new StreamUpload<span class="signature">(sourceStream, blob, authData)</span><span class="type-signature"></span></h4>

    



<div class="description">
    <p>Constructor: initialize a StreamUpload object.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>sourceStream</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last"><p>Stream containing the data to be sent</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>blob</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>Name of the blob (starting with /)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>authData</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last"><p>Authentication data</p>
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>storageAccountName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>Name of the Azure Storage Account (required)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>storageAccountKey</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>Key of the Azure Storage Account (required if <code>storageAccountSasToken</code> is not set)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>storageAccountSasToken</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>SAS token (required if <code>storageAccountKey</code> is not set)</p></td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="StreamUpload.js.html">StreamUpload.js</a>, <a href="StreamUpload.js.html#line17">line 17</a>
    </li></ul></dd>
    

    

    

    
</dl>
















    
    </div>

    

    

    

     

    

    
        <h3 class="subsection-title">Members</h3>

        
            
<h4 class="name" id="blockSize"><span class="type-signature"></span>blockSize<span class="type-signature"> :number</span></h4>




<div class="description">
    <p>Size of each block uploaded, in bytes.</p>
<p>The maximum size imposed by Azure Blob Storage is 100MB; by default, we are using
a smaller block size to reduce memory footprint.</p>
<p>Note that the maximum number of blocks per blob remain 50,000, regardless of the size
of each block.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">number</span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="StreamUpload.js.html">StreamUpload.js</a>, <a href="StreamUpload.js.html#line69">line 69</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="blocksPerBlob"><span class="type-signature"></span>blocksPerBlob<span class="type-signature"> :number</span></h4>




<div class="description">
    <p>Number of blocks in each blob. Each block is at most 100MB in size.</p>
<p>When using smaller values, you will potentially have a bigger number separate
blobs inside your Azure Storage Account. Because performance targets are applied at
each individual blob, retrieving data might be faster if you have more blobs, as
you can download them in parallel. This has no effect on upload speed.</p>
<p>The maximum value is 50,000, as imposed by Azure Blob Storage.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">number</span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="StreamUpload.js.html">StreamUpload.js</a>, <a href="StreamUpload.js.html#line95">line 95</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="concurrency"><span class="type-signature"></span>concurrency<span class="type-signature"> :number</span></h4>




<div class="description">
    <p>Number of parallel upload tasks.</p>
<p>Please note that the higher the number of parallel uploads, the more memory is required.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">number</span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="StreamUpload.js.html">StreamUpload.js</a>, <a href="StreamUpload.js.html#line113">line 113</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="endpoint"><span class="type-signature"></span>endpoint<span class="type-signature"> :string</span></h4>




<div class="description">
    <p>Set what endpoint to use for Azure Blob Storage.</p>
<p>The default value is 'blob.core.windows.net' (Azure Global).
Other options you might want to leverage:</p>
<ul>
<li>Azure China: 'blob.core.chinacloudapi.cn'</li>
<li>Azure Germany: 'blob.core.cloudapi.de'</li>
</ul>
<p>For Azure Stack, use your custom endpoint.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">string</span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="StreamUpload.js.html">StreamUpload.js</a>, <a href="StreamUpload.js.html#line164">line 164</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="md5"><span class="type-signature"></span>md5<span class="type-signature"> :boolean</span></h4>




<div class="description">
    <p>Calculate MD5 of blocks before uploading them, to ensure integrity during transfer.
This is enabled by default.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">boolean</span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="StreamUpload.js.html">StreamUpload.js</a>, <a href="StreamUpload.js.html#line130">line 130</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="singleBlob"><span class="type-signature"></span>singleBlob<span class="type-signature"> :boolean</span></h4>




<div class="description">
    <p>Do not append a suffix to the file name. This will ensure that for files or streams
that can fit one blob, no &quot;.000&quot; suffix is added. However, uploads of larger files
will fail.
This is disabled by default.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">boolean</span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="StreamUpload.js.html">StreamUpload.js</a>, <a href="StreamUpload.js.html#line145">line 145</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="commitBlockBlob"><span class="type-signature"></span>commitBlockBlob<span class="signature">(blockCount, seqId<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise}</span></h4>

    



<div class="description">
    <p>Commit a block blob into Azure Blob Storage by sending the list of blocks.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>blockCount</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Number of blocks uploaded. This will be used to re-generate the block ids</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>seqId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Optional suffix for the blob name (for storing files bigger than 4.8TB)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="StreamUpload.js.html">StreamUpload.js</a>, <a href="StreamUpload.js.html#line268">line 268</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Promise containing the result of the operation</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="generateBlockId"><span class="type-signature"></span>generateBlockId<span class="signature">(blockNum)</span><span class="type-signature"> &rarr; {string}</span></h4>

    



<div class="description">
    <p>Generate a block id. This implementation returns the number of the block with padding 0's in front, converted to base64</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>blockNum</code></td>
            

            <td class="type">
            
                
<span class="param-type">int</span>


            
            </td>

            

            

            <td class="description last"><p>Number of block</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="StreamUpload.js.html">StreamUpload.js</a>, <a href="StreamUpload.js.html#line391">line 391</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Block id for use with Azure Blob Storage</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="putBlock"><span class="type-signature"></span>putBlock<span class="signature">(block, blockId, seqId<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise}</span></h4>

    



<div class="description">
    <p>Upload a block of data to the block blob in Azure Blob Storage</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>block</code></td>
            

            <td class="type">
            
                
<span class="param-type">Buffer</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Block of data to upload (maximum 100MB in size)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>blockId</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>ID of the block</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>seqId</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>Optional suffix for the blob name (for storing files bigger than 4.8TB)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="StreamUpload.js.html">StreamUpload.js</a>, <a href="StreamUpload.js.html#line325">line 325</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Promise containing the result of the operation</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="upload"><span class="type-signature"></span>upload<span class="signature">()</span><span class="type-signature"> &rarr; {Promise}</span></h4>

    



<div class="description">
    <p>Start upload of the stream</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="StreamUpload.js.html">StreamUpload.js</a>, <a href="StreamUpload.js.html#line179">line 179</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <p>Promise containing the result of the upload</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise</span>


    </dd>
</dl>

    



        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Authorization.html">Authorization</a></li><li><a href="StreamUpload.html">StreamUpload</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>