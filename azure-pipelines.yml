pool:
  vmImage: 'Ubuntu 16.04'

steps:
- task: NodeTool@0
  inputs:
    versionSpec: '8.x'
  displayName: 'Install Node.js'

- script: |
    npm install --production
  displayName: 'Run npm install in the project'

- script: |
    npm install -g pkg
  displayName: 'Install pkg globally'

- script: |
    'pkg --targets node8-linux-x64,node8-macos-x64,node8-win-x64 --out-path $(Build.ArtifactStagingDirectory)/dist/ .'
  displayName: 'Build binaries with pkg for Linux, macOS and Windows'

- task: PublishBuildArtifacts@1
  displayName: 'Publish build artifacts'
